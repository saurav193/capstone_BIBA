---
title: "logistic_regression"
author: "Reiko Okamoto"
date: "07/06/2020"
output: github_document
---
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(modelr)
library(MASS)
library(Metrics)
X_train_hi <- read_csv("../data/X_train_hi.csv")
X_valid_hi <- read_csv("../data/X_valid_hi.csv")
y_train_hi <- read_csv("../data/y_train_hi.csv")
y_valid_hi <- read_csv("../data/y_valid_hi.csv")
X_train_lo <- read_csv("../data/X_train_lo.csv")
X_valid_lo <- read_csv("../data/X_valid_lo.csv")
y_train_lo <- read_csv("../data/y_train_lo.csv")
y_valid_lo <- read_csv("../data/y_valid_lo.csv")
X_train_hi <- X_train_hi %>%
dplyr::select(-X1)
X_valid_hi <- X_valid_hi %>%
dplyr::select(-X1)
y_train_hi <- y_train_hi$unacast_session_count
y_valid_hi <- y_valid_hi$unacast_session_count
X_train_hi_model <- X_train_hi %>%
mutate(target = y_train_hi - 300)
poisson_hi <- glm(formula = target ~ ., family = "poisson", data = X_train_hi_model)
poisson_hi %>%
broom::tidy()
y_pred_train_hi <- predict(poisson_hi, X_train_hi, type="response") %>%
broom::tidy() %>%
mutate(x = x + 300) %>%
pull(x)
hi_train <- data.frame(y_train_hi, y_pred_train_hi) %>%
mutate(res = y_train_hi - y_pred_train_hi)
ggplot(hi_train, aes(y_train_hi, res)) +
geom_point()
Metrics::rmse(hi_train$y_train_hi, hi_train$y_pred_train_hi)
y_pred_valid_hi <- predict(poisson_hi, X_valid_hi, type="response") %>%
broom::tidy() %>%
mutate(x = x + 300) %>%
pull(x)
hi_valid <- data.frame(y_valid_hi, y_pred_valid_hi) %>%
mutate(res = y_valid_hi - y_pred_valid_hi)
ggplot(hi_valid, aes(y_valid_hi, res)) +
geom_point()
Metrics::rmse(hi_valid$y_valid_hi, hi_valid$y_pred_valid_hi)
outlier <- hi_valid %>%
arrange(res) %>%
head(1) %>%
pull(y_valid_hi)
X_valid_hi_w_target <- X_valid_hi %>%
mutate(target = y_valid_hi)
X_valid_hi_w_target %>%
filter(target == outlier)
X_train_lo <- X_train_lo %>%
dplyr::select(-X1)
X_valid_lo <- X_valid_lo %>%
dplyr::select(-X1)
y_train_lo <- y_train_lo$unacast_session_count
y_valid_lo <- y_valid_lo$unacast_session_count
X_train_lo_model <- X_train_lo %>%
mutate(target = y_train_lo)
poisson_lo <- glm(formula = target ~ ., family = "poisson", data = X_train_lo_model)
poisson_lo %>%
broom::tidy()
y_pred_train_lo <- predict(poisson_lo, X_train_lo, type="response") %>%
broom::tidy() %>%
pull(x)
lo_train <- data.frame(y_train_lo, y_pred_train_lo) %>%
mutate(res = y_train_lo - y_pred_train_lo)
ggplot(lo_train, aes(y_train_lo, res)) +
geom_point()
Metrics::rmse(lo_train$y_train_lo, lo_train$y_pred_train_lo)
y_pred_valid_lo <- predict(poisson_lo, X_valid_lo, type="response") %>%
broom::tidy() %>%
pull(x)
lo_valid <- data.frame(y_valid_lo, y_pred_valid_lo) %>%
mutate(res = y_valid_lo - y_pred_valid_lo)
ggplot(lo_valid, aes(y_valid_lo, res)) +
geom_point()
Metrics::rmse(lo_valid$y_valid_lo, lo_valid$y_pred_valid_lo)
